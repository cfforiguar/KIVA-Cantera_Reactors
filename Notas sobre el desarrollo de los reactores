Diagnóstico de los errores en el reactor
  -Los resultados no son acordes con los de Chemkin (pero se parecen)
  -Chemkin muestra que en el WSR hay pérdida de masa en el reactor, véase 
   la imagen "acumulación masa WSR.png"
  -Cuando se cuadra Cantera para que de similar a "acumulación masa WSR.png" 
   se corrobora que la presión es constante y el reactor funciona. Véase
   changeset del PSR 20 (9e76a3bfbf70)
  -Los papers nunca hablan de una masa de entrada y otra de salida 
    -Revisando Turns y comparando con las tesis:
      -Las tesis hablan de un reactor de estado estable d(m)/dt=0
      -OJO: El reactor PSR de CHEMKIN no es de estado estable
    -Mantilla habla de una velocidad e entrada basada en la velocidad del
     flujo, pero el problema es que para el método numérico el flujo está 
     parado en ese instante.
      -Mantilla sugiere que están usando splitting
    -Cantera incorpora un objeto válvula que deja salir flujo para tener
     la presión constante. Lo cual es un despropósito para el modelo por
     que:
      -Se cae Cantera a menos que uno haga la constante K de la válvula   
       muy pequeña. Eso equivale a decirle que por la válvula no sale 
       nada a menos que la diferencia de presión entre el reactor y el   
       exterior sea inmensa. La válvula gobierna el flujo másico por:
       dot(m)= K*Delta(p).
       http://www.cantera.org/docs/doxygen/html/flowControllers_8h_source.html
      -Además como se le define al reactor una K que funcione siempre?
        -¿Que intente con una y con otra?
        -¿Que haya una función que deje la presión constante como en 
         chemkin ó usar una función que deje el flujo másico constante?
        -¿Usar un massflowcontroller para mantener el flujo másico cte?
    -Para Chemkin no existe el objeto válvula de Cantera para el PSR
    -Para Chemkin la cantidad de masa dentro del reactor WSR varía. De
     este modo se introducen aberraciones en las ecuaciones de continuidad
     que podrían hacer caer a KIVA.
      -Cuando se introduce un reactor similar en Cantera, efectivamente KIVA
       se cae
    -Lograr que el flujo másico es constante se podría hacer de 2 formas:
      -Hacer que el flujo del objeto válvula sea igual al de salida
        -Cambio forzado en la presión
        -Hace necesario llenar de nuevo el reactor con algo que no se  
         sabe qué es:
          -Mezcla fresca
            -Introduzco energía artficialmente (energías de formación)
          -Recircular la mezcla de la válvula a la entrada
            -Si el volumen es constante, la presión es variable y la
             mezcla recircula ¿No se está forzando un reactor de volumen  
             constante? 
              -Consistente con Golovitchev.
              -Cantera solamente soluciona si K es pequeño->dot(m)=0
      -Poner un massflowcontroller a la salida -> Es lo más sencillo

-facsec: Este valor escala la energía añadida en función del tamaño del sector que se está simulando. Se multiplica el cambio de energía por facsec. El cual está definido en rinput.f en las líneas 246-248.

-OJO: El reactor de Cantera por alguna extraña razón está reaccionando a    
  temperaturas y presiones muy bajas véase changeset:19 (ce3eb4e20c04) 



 -CASO RARO para KIVA changeset 21 (35b93cef9759):
  Para las condiciones: 
  {780.01976566582402, 4.073069760955634e-11, 2710136.9228358548,    
   1.4290448509694117e-05, 3.4361407312040838e-05, 0, 0, 0, 0, 0}
  y composiciones:
  {0, 0.23200000000000034, 0.76799999999999957, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
  Se tiene como resultado:
  {0, 0.2320000000000004, 0.76799999999999979, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}

   -Lo que genera ratas de reacción ficticias que a su vez conlleva a que haa 
   cambios bruscos de energía y de masa. Además de violaciones a las leyes de 
   consevación de energía y masa. Dichos cambios de energía se deben a que de 
   la nada se está perdiendo-ganando O2 y N2 con sus respectivas energías de 
   formación.

   -Se sugiere fuertemente hacer uso de fuertes controles al reactor para que 
   conserve la masa ó de alguna forma blindar a KIVA de estos cambios.

-Paraview: Se debe usar una versión reciente de Paraview y al abrir el arcchivo intentar con las 2 opciones que muestra para abrir el archivo.La compatibilidad de paraview con GMV es pobre.

-FIXME: OJO OJO BUG: me estoy bajando el combustioble con fracciones másicas negativas al 
hacer spdarray = 0 y no lo estoy reponiendo más adelante

-TODO: Hallar energía total en el reactor antes y después de solucionar
-TODO: Hallar cambio en la energía interna en la reacción
-TODO: Probar un reactor problemático usando el mecanismo on y sin NO y N
-TODO: Recuperar las masas negativas inyectadas en KIVA -->Enviar mail a hkmoffat en sandia

-Pruebas con chemkin con el reactor en estado estacionario para la masa: Mantilla lo usa como argumento para hacer energy:off.
  -La energía no se reinvierte en la reacción si no en la difusión de las especies y otros procesos
    -Esto evita que existan reactores con alta liberación de calor en las pruebas HCCI
  -El no calcular cambios en temperatura para el reactor es coherente con el esquema numérico de KIVA. Pues KIVA ajusta las temperaturas al final
    -El reactor viene a ser un predictor de las densidades
      -Esto se evidencia por que cada vez que Cantera termina una iteración grande las densidades iniciales de los reactores no son las finales del paso anterior

-Al Usar el mecanismo original de Patel deshabilitando se sigue observando las falsas reacciones
 
-El error en el changeset 24 (5982dd7d0c90) no es tal. El "error" se debe a
que Cantera balancea de forma automática las fracciones másicas si estas no suman 1. Lo mismo aplica para el changeset 19


-La masa sí se conserva en KIVA, lo que sucede es que la presición al parecer no es suficiente y quedan pequeños desbalances que toca corregir volviendo a sacar las fracciones másicas.

-Lista de problemas:
  -Un reactor reacciona muy rápido

-Lista de parámetros sospechosos
 -NO y N agregados al mecanismo -> Especies negativas en Cantera
 -Poner ecuación de energía ->Liberación excesiva de energía, concentración de especies
 -Reactor
   -¿flujo másico de entrada?
   -¿tipo de reactor?
 -Calculo de la densidad ->cambios bruscos en la densidad
 
-TODO: Partir el delta de tiempo si las concentraciones son negativas
-TODO: p,t,vol, =cte en cada paso de tiempo en cada reactor
-TODO: En el apéndice C del manual de KIVA-II está parte del spray

-TODO: OJO: reevaluar las unidades de:
  -dechem=-1.0d0*(sum(dprod(domeg_isp,rmw*ct_hf))*(1.0d0))*(1.0d7/(1.0d3))
  *pues ct_hf creo que está en J/kmol
  *rmw no dice en qué está
-Lista de posibes soluciones?
  -
  -Seguir los reactores problemáticos -> ¿cómo hago para cogerlos cuando KIVA los coja?--->


-chem.f
 -Hacer un solo switch para todos los unit tests
    -Avisar sólo del evento que disparó el error
 -Tener un blacklist de reactores que va a imprimir en el tiempo
 -Tener conciencia del ciclo en el que se está
 -Tener la posibilidad de detectar reactores problemáticos e inprimirlos
 -Ver cómo funciona el coso que avisa el paso de tiempo en KIVA en medio de la 
  reacción para rearrancar todo de nuevo.
-Hacer un unit test en fortran
 -Leer los reactores problemáticos impresos desde KIVA
 -
-cppwrapper
  -Hacer un solo switch para todos los unit tests
    -Avisar sólo del evento que disparó el error
  -Recibir el ciclo y el # de reactor de Cantera
  -Imprimir un archivo con los errores: Ciclo, # de reactor y error de Cantera

ACTIVIDADES HOY:

-Hacer la malla del HCCI de Kong-> en progreso
-Hacer la solicitud de un computador-> en progreso

-Volver a usar Inyectores Diesel
 -Arreglar lo del Diesel que me tumbo al evaporar
 -Correr la malla Diesel con inyección
 
-Tomar la malla simple de chispa de Hessel
 -Correrla en 2D

-Hacer copia de seguridad en la universidad
-Escribir como si no hubiera mañana mientras corre el resto

$13 = {555.06205398759766, 3.0678609884673958e-12, 2862994.2613387257, 2.8573779400222172e-06, 0, 1120, 0, 0, 0, 0}
(idb) 
$14 = {0.20437533262818239, 0.1845849227137116, 0.61103974443324804, 2.083330756325355e-23, 1.5706053141239318e-11, 8.6868228784609325e-20, 6.387400048742122e-20, 2.0790387784301324e-18, 0, 1.7852206800476376e-12, 5.9922923475406238e-14, 0, 3.6483844698485572e-15, 2.6486314361855431e-11, 2.0083766006062917e-20, 3.7462718480122287e-13, 2.3910472611450827e-22, 1.8328753866443247e-26, 1.0138270465301024e-14, 1.5475281865662352e-22, 2.1042676869476795e-24, 3.2635609418881846e-13, 4.5613689063733883e-15, 1.3536949752830968e-26, 9.7747495006483046e-26, 1.863096257896743e-13, 5.4584766705065651e-14, 5.6985696461480732e-13, 7.0554637748855087e-11, 1.0772768441396482e-10, 1.0078533573285954e-12}
$15 = {0.20437533261692803, 0.18458492270970442, 0.61103974443324804, 2.0913641288877259e-23, 1.7717652270300038e-11, 5.5796283547977182e-25, 6.851329911592747e-20, 2.0794078605277212e-18, 0, 1.0672479929697015e-16, 5.9924113395562509e-14, 0, 1.5305848327517203e-14, 2.6490554270750716e-11, 6.9422034705822631e-20, 3.7537699228080914e-13, 4.0427546767360184e-26, 1.9263246037175538e-29, 9.7681965334967935e-15, 5.1880866788205658e-22, -3.6310321302795249e-27, 3.3084038888743872e-13, -7.5614801797971143e-17, 1.6134899222527601e-26, 1.2479967070923239e-25, 1.8631012529113841e-13, 5.4576782521607476e-14, 1.0543838394677789e-16, 8.5167691164073775e-11, 1.0870336707596227e-10, 1.0078622800725088e-12}

$17 = {611.00487035095932, 9.8207314604637503e-13, 2933458.7347427849, 2.5106653952824108e-06, 0, 1119, 0, 0, 0, 0}
(idb) 
$18 = {0.26488759594563976, 0.17054607574043368, 0.56456632452281774, 2.2050436722801014e-22, 2.2748111165286096e-10, 2.3888176125775558e-19, 1.1388194108393407e-17, 1.7471698255791945e-17, 0, 4.6525361120560474e-13, 5.7598258165671428e-13, 0, 1.3897772166325143e-12, 3.4443681884296344e-10, 4.841955850865631e-18, 3.7396012073404725e-12, 7.624739511759586e-22, 4.9515666971288676e-26, 9.3188845376160211e-14, 3.723603624973589e-20, 5.1561512137415909e-24, 3.0109893803132359e-12, 1.3968792054274604e-14, 2.9705652347319673e-24, 1.565579988527734e-23, 1.6499624176347482e-12, 4.7140954073836034e-13, 5.0771177271648411e-12, 1.3744175852630924e-09, 1.8182892251752538e-09, 9.9967599664211199e-12}
(idb) 
$19 = {0.26488759589975153, 0.17054607571102656, 0.56456632452281774, 2.235354629601077e-22, 2.350698357092448e-10, 3.6041227903601401e-22, 1.1454762218085583e-17, 1.7472945238243056e-17, 0, 4.876462768116656e-15, 5.7627434733603234e-13, 0, 2.0808775923275449e-12, 3.4432320241463026e-10, 9.7750059393042417e-18, 3.7526154126926115e-12, 1.6733999559836542e-23, 2.7229234992646729e-27, 8.7921122911099704e-14, 7.4412873186797119e-20, 1.860662081012147e-26, 3.0254589085468692e-12, -1.0840160850131973e-17, 3.7521135957949383e-24, 1.8946855056324183e-23, 1.6500119538987507e-12, 4.7088337528703252e-13, 1.1009922502883413e-13, 1.3894112740753538e-09, 1.8758390658958708e-09, 1.0001756742302198e-11}

$20 = {636.00208057642169, 3.1713322752445875e-12, 3216621.0996568338, 2.484745073391353e-06, 0, 1043, 0, 0, 0, 0}
(idb) 
$21 = {0.25457415181044302, 0.17293879547896301, 0.57248705030064828, 1.9742478682262236e-22, 1.291213344534534e-10, 6.6768071090302517e-19, 3.8221621051560373e-18, 1.7296703963090969e-17, 0, 1.9255503866408459e-12, 3.8105223699007734e-13, 0, 2.1150816193941234e-13, 2.4775291734247231e-10, 9.4140205740650512e-19, 2.1218998174652651e-12, 1.8825401842955104e-21, 1.7156887303985878e-25, 6.5841083606638e-14, 7.247001963455283e-21, 2.4481682102748475e-23, 2.6995990000773686e-12, 7.3368359856280978e-14, 6.0633150928027021e-25, 5.4540245854182523e-24, 1.6762103137883443e-12, 3.25657217293433e-13, 6.8989520002455274e-12, 9.7656711381887143e-10, 1.0337607198117551e-09, 6.3640113985220868e-12}
(idb) 
$22 = {0.2545741517345419, 0.17293879543265742, 0.57248705030064828, 1.9973099404376262e-22, 1.4093243688402129e-10, 7.4894811934337823e-22, 4.0174369590431872e-18, 1.7301138880371039e-17, 0, 6.0859541423918526e-15, 3.8172828331861165e-13, 0, 1.0709679715100273e-12, 2.4952998571938373e-10, 3.5042073390493555e-18, 2.1368307048279397e-12, 9.9149632292919346e-24, 1.5442049868209318e-27, 6.100979286856246e-14, 2.6676842018381097e-20, -2.1797871777220373e-26, 2.7723820106153658e-12, 1.5016718266436023e-16, 1.120799049719817e-24, 8.853614264787612e-24, 1.6764243441915304e-12, 3.2488017411363985e-13, 1.6225961240664957e-13, 1.013710475787496e-09, 1.1130117359315036e-09, 6.3749370755239565e-12}


$23 = {562.35593175214581, 3.2276834128164553e-12, 3600748.9799281643, 2.532218027365692e-06, 0, 1017, 0, 0, 0, 0}
(idb) 
$24 = {0.50684186706920209, 0.11441268558187183, 0.3787454449180756, 1.8200051595518699e-22, 1.3385100739189931e-10, 4.8750695402749357e-19, 7.3515677359793118e-18, 1.481824584251937e-17, 0, 9.0175596088856803e-13, 3.7903407489815544e-13, 0, 6.2004855823389399e-13, 2.4267779030585444e-10, 1.9534687231386555e-18, 2.1708778330736395e-12, 1.4016966788746473e-21, 1.1362575581246923e-25, 6.1843344876998437e-14, 1.5033458173727913e-20, 1.5465460712983841e-23, 2.5135445187291813e-12, 6.0045786007562609e-14, 9.9837854299997465e-25, 8.096138395710534e-24, 1.5158545408635525e-12, 3.360858599550844e-13, 7.4673796928200213e-12, 9.684388791636232e-10, 1.0635074217435256e-09, 6.3488005599185354e-12}
(idb) 
$25 = {0.50684186705358991, 0.11441268557157569, 0.37874544491807571, 1.8385084486515991e-22, 1.3638426461677045e-10, 1.1357786856992687e-23, 7.4384405083322123e-18, 1.481850818037517e-17, 0, 4.1665392941171177e-16, 3.7904473327564857e-13, 0, 1.0952620168107446e-12, 2.4232500273842101e-10, 5.950096927179147e-18, 2.1754842130779754e-12, 4.1853294388832961e-24, 1.4195477062901072e-27, 5.959000353393574e-14, 4.4633009215521383e-20, 9.2531389311598856e-28, 2.5715757756867875e-12, -5.9771864683621754e-18, 1.2357743360199609e-24, 1.0217642462097322e-23, 1.5158562968088796e-12, 3.3602516461519485e-13, 2.1461424607160768e-14, 9.8725221026454456e-10, 1.076293558212704e-09, 6.348950228644969e-12}


MIRAR LO DE LA INYECCIÓN PARA QUE DE  ALGO LÓGICO, POR QUE SE CAE Y PUEDE SER POR QUE ESTÁ CON UN PHI > 25 (HAY MÁS MASA DE COMBUSTIBLE QUE DE AIRE)


Hipótesis 

